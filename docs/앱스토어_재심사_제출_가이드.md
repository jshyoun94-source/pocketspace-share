# 앱스토어 재심사 제출 가이드

## 1. GitHub 업로드 → Xcode 빌드 → 심사 제출 순서

### 1단계: GitHub에 코드 올리기

1. 터미널에서 프로젝트 폴더로 이동:
   ```bash
   cd /Users/jsh/pocketspace-cursor/pocketspace-share
   ```

2. 변경 사항 확인:
   ```bash
   git status
   ```

3. 커밋 및 푸시 (원격 저장소가 이미 연결되어 있다고 가정):
   ```bash
   git add .
   git commit -m "Sign in with Apple, 회원 탈퇴, 동네생활/동네부탁 로딩 개선 등 심사 대응"
   git push origin main
   ```
   - 브랜치 이름이 `main`이 아니면 해당 브랜치로 `git push origin <브랜치명>` 사용.

---

### 2단계: iOS 빌드 생성 (Xcode / EAS)

**방법 A: Xcode에서 아카이브 후 업로드**

1. 네이티브 iOS 프로젝트 생성/갱신 (Expo 사용 시):
   ```bash
   npx expo prebuild --platform ios --clean
   ```

2. Xcode에서 열기:
   ```bash
   open ios/PocketSpace.xcworkspace
   ```
   (또는 `ios/PocketSpace.xcodeproj` — CocoaPods 사용 시에는 `.xcworkspace` 권장)

3. Xcode에서:
   - 상단 스킴에서 **PocketSpace** 선택, 대상 기기 **Any iOS Device (arm64)** 선택.
   - 메뉴 **Product** → **Archive**.
   - 아카이브 완료 후 **Organizer** 창에서 해당 아카이브 선택 → **Distribute App** → **App Store Connect** → **Upload**.
   - 업로드 완료 시 App Store Connect에 새 빌드(버전 1.0.0 (3) 등)가 나타남.

**방법 B: EAS Build 사용**

1. EAS CLI 설치(미설치 시):
   ```bash
   npm install -g eas-cli
   eas login
   ```

2. 프로젝트 루트에서:
   ```bash
   eas build --platform ios --profile production
   ```

3. 빌드 완료 후 EAS 대시보드 또는 링크에서 **Submit to App Store** 하거나, 다운로드한 `.ipa`를 Transporter 앱으로 제출.

---

### 3단계: App Store Connect에서 심사 재제출

1. [App Store Connect](https://appstoreconnect.apple.com) 로그인 → **내 앱** → **포켓스페이스** 선택.

2. **앱** 정보에서 해당 **iOS 앱** (1.0) 선택.

3. **배포** 또는 **앱 스토어** 탭에서:
   - 이전에 “심사를 통과하지 못함” 표시된 버전 옆 **편집** 클릭.

4. **빌드** 항목에서:
   - **+** 또는 “선택” 클릭 후, 방금 업로드한 **새 빌드** (예: 1.0.0 (3)) 선택 → **완료**.

5. **심사용 메모** / **버전 정보**의 “앱 검토 팀에게 전할 메시지” 란에 아래 **재심사 문구**를 복사해 붙여넣기.

6. **데모 계정** (Guideline 2.1 대응):
   - **앱 검토 정보** 또는 **버전 정보**의 “로그인 정보”에 **2단계 인증이 꺼진** 테스트 계정(이메일/비밀번호) 입력.
   - 채팅 등 모든 기능을 사용할 수 있는 계정이어야 함.

7. 저장 후 **심사에 제출** (또는 “제출하여 검토” 버튼) 클릭.

---

## 2. 재심사 시 복사·붙여넣기용 문구

아래 블록을 **그대로** 복사해서 App Store Connect의 “앱 검토 팀에게 전할 메시지”에 붙여넣으면 됩니다.

---

### [영문 — 권장]

```
Thank you for your feedback. We have addressed all issues as follows:

■ Guideline 4.8 – Login Services
We have added "Sign in with Apple" as an equivalent login option. It is available on the login screen alongside other sign-in methods. Sign in with Apple:
- Limits data collection to the user’s name and email address.
- Allows users to hide their email (private relay).
- Does not use app interactions for advertising without consent.

■ Guideline 5.1.1(v) – Data Collection and Storage (Account Deletion)
Account deletion is implemented inside the app:
- Path: Tap the "나의 포스" (My Profile) tab in the bottom bar → tap the "설정" (Settings) tab at the top → scroll down to "회원 탈퇴" (Delete Account).
- Tapping "회원 탈퇴" shows a confirmation dialog. Confirming permanently deletes the Firebase Auth account and the user document in Firestore; the action cannot be undone.

■ Guideline 2.1 – App Completeness (Loading issue)
The indefinite loading when tapping "동네생활" (Community) and "동네부탁" (Neighborhood Requests) has been fixed. Required Firestore indexes have been created and we have verified behavior on iPad (e.g. iPad Air 11-inch).

■ Demo accounts (Guideline 2.1 – Information Needed)
We provide two test accounts for review; both use the same email address.

• Naver account (primary test data):
  - Email: jshyoun94@naver.com
  - Password: Tmd4929000&
  - This account has 2 registered spaces and 2 neighborhood request posts ("동네부탁") so reviewers can test listing and chat flows easily. One of the spaces already has a chat thread started by the Apple account below.

• Apple account (Sign in with Apple + Chat):
  - Email: jshyoun94@naver.com
  - Password: tmD004929!
  - Use "Sign in with Apple" on the login screen with this Apple ID to test Apple login and the existing chat on one of the Naver-registered spaces.

If the Apple ID requires two-factor authentication for sign-in, please request verification via YouTube (as agreed with our team); we will approve the request immediately so review can proceed without delay.
```

---

### [한글 — 필요 시 사용]

```
검토해 주셔서 감사합니다. 아래와 같이 모든 항목을 반영했습니다.

■ Guideline 4.8 – 로그인 서비스
"Sign in with Apple"을 동등한 로그인 옵션으로 추가했습니다. 로그인 화면에서 다른 로그인 방법과 함께 제공됩니다. Sign in with Apple은:
- 수집 데이터를 사용자 이름과 이메일로 제한합니다.
- 이메일 비공개(Private Relay)를 지원합니다.
- 동의 없이 앱 이용 정보를 광고에 사용하지 않습니다.

■ Guideline 5.1.1(v) – 데이터 수집 및 저장 (계정 삭제)
계정 삭제 기능을 앱 내에 구현했습니다.
- 위치: 하단 탭에서 "나의 포스" 선택 → 상단 "설정" 탭 선택 → 아래로 스크롤 후 "회원 탈퇴" 선택.
- "회원 탈퇴" 탭 시 확인 대화상자가 표시되며, 확인 시 Firebase Auth 계정 및 Firestore 사용자 문서가 영구 삭제되며 복구할 수 없습니다.

■ Guideline 2.1 – 앱 완성도 (로딩 문제)
"동네생활" 및 "동네부탁" 탭 시 무한 로딩되던 현상을 수정했습니다. 필요한 Firestore 인덱스를 생성했으며, iPad(iPad Air 11-inch 등)에서 동작을 확인했습니다.

■ 데모 계정 (Guideline 2.1 – 필요한 정보)
검토용 테스트 계정은 네이버 계정과 애플 계정 두 가지이며, 이메일 주소는 동일합니다.

• 네이버 계정 (테스트 데이터 포함):
  - 이메일: jshyoun94@naver.com
  - 비밀번호: Tmd4929000&
  - 이 계정으로 공간 2곳, 동네부탁 글 2개를 미리 등록해 두었습니다. 공간 중 한 곳은 아래 애플 계정으로 채팅을 걸어 둔 상태라 채팅 플로우 테스트에 활용하실 수 있습니다.

• 애플 계정 (Sign in with Apple 및 채팅 테스트):
  - 이메일: jshyoun94@naver.com
  - 비밀번호: tmD004929!
  - 로그인 화면에서 "Sign in with Apple"으로 이 Apple ID로 로그인하시면 Apple 로그인과 네이버 계정이 등록한 공간의 채팅을 확인하실 수 있습니다.

애플 계정에 2단계 인증이 설정되어 로그인이 어려우시면, 유튜브로 인증 요청을 보내 주시면 바로 승인하겠습니다.
```

---

## 3. 제출 전 체크리스트

- [ ] GitHub에 최신 코드 푸시 완료
- [ ] iOS 빌드(Archive 또는 EAS) 후 App Store Connect에 업로드 완료
- [ ] App Store Connect에서 해당 버전에 **새 빌드** 연결
- [ ] **심사용 메모**에 위 재심사 문구 붙여넣기
- [ ] **데모 계정**(2FA 미사용) 로그인 정보 입력
- [ ] 앱 스크린샷/메타데이터가 수정된 앱(Apple 로그인 등)과 일치하는지 확인 후 **심사에 제출**
